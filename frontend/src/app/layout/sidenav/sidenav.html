<div class="sidebar-header">
  <div class="view-toggle">
    <mat-checkbox
      [checked]="showPlugins()"
      (change)="togglePluginView()"
      color="primary">
      <span class="toggle-label">
        <mat-icon>{{ showPlugins() ? 'extension' : 'apps' }}</mat-icon>
        {{ showPlugins() ? 'Plugin View' : 'Classic View' }}
      </span>
    </mat-checkbox>
  </div>

  <mat-divider></mat-divider>

  <div class="search-container">
    <mat-form-field appearance="outline" class="search-field">
      <mat-label>Search tools & analysis</mat-label>
      <input matInput
             [value]="searchQuery()"
             (input)="updateSearch($any($event.target).value)"
             placeholder="Type to search...">
      <mat-icon matPrefix>search</mat-icon>
      @if (searchQuery()) {
        <button matSuffix mat-icon-button (click)="clearSearch()" type="button">
          <mat-icon>clear</mat-icon>
        </button>
      }
    </mat-form-field>
  </div>
</div>

<mat-nav-list class="sidenav-list">
  @if (filteredNavItems().length === 0) {
    <div class="no-results">
      <mat-icon>search_off</mat-icon>
      <p>No results found for "{{ searchQuery() }}"</p>
    </div>
  }
  @for (item of filteredNavItems(); track item.label) {
    @if (item.children) {
      <mat-expansion-panel class="nav-expansion-panel">
        <mat-expansion-panel-header>
          <mat-panel-title>
            <mat-icon>{{ item.icon }}</mat-icon>
            <span>{{ item.label }}</span>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-nav-list>
          @for (child of item.children; track child.label) {
            <a mat-list-item (click)="navigate(child.route!)" class="nav-child-item">
              <mat-icon matListItemIcon>{{ child.icon }}</mat-icon>
              <span matListItemTitle>{{ child.label }}</span>
            </a>
          }
        </mat-nav-list>
      </mat-expansion-panel>
    } @else {
      <a mat-list-item (click)="navigate(item.route!)" class="nav-item">
        <mat-icon matListItemIcon>{{ item.icon }}</mat-icon>
        <span matListItemTitle>{{ item.label }}</span>
      </a>
    }
  }
</mat-nav-list>
