plugin:
  id: "imputation"
  name: "Missing Value Imputation"
  description: "Impute missing values using various methods"
  version: "1.0.0"
  author: "CauldronGO Team"
  category: "preprocessing"
  icon: "auto_fix_high"

runtime:
  type: "python"
  script: "imputation.py"

inputs:
  - name: "input_file"
    label: "Input File"
    type: "file"
    required: true
    accept: ".csv,.tsv,.txt"
    description: "Data file with missing values"

  - name: "columns"
    label: "Columns to Impute"
    type: "column-selector"
    required: false
    multiple: true
    sourceFile: "input_file"
    description: "Select columns to impute (empty = all columns)"

  - name: "method"
    label: "Imputation Method"
    type: "select"
    required: true
    default: "knn"
    options:
      - "knn"
      - "simple"
      - "iterative"
      - "constant"
    description: "Method to use for imputation"

  - name: "k"
    label: "Number of Neighbors (KNN)"
    type: "number"
    default: 5
    min: 1
    max: 20
    step: 1
    description: "Number of neighbors for KNN imputation"
    visibleWhen:
      field: "method"
      equals: "knn"

  - name: "strategy"
    label: "Simple Strategy"
    type: "select"
    default: "mean"
    options:
      - "mean"
      - "median"
      - "most_frequent"
    description: "Strategy for simple imputation"
    visibleWhen:
      field: "method"
      equals: "simple"

  - name: "fillValue"
    label: "Fill Value (Constant)"
    type: "number"
    default: 0.0
    description: "Value to use for constant imputation"
    visibleWhen:
      field: "method"
      equals: "constant"

  - name: "iterations"
    label: "Max Iterations (Iterative)"
    type: "number"
    default: 10
    min: 1
    max: 100
    step: 1
    description: "Maximum iterations for iterative imputation"
    visibleWhen:
      field: "method"
      equals: "iterative"

outputs:
  - name: "imputed_data"
    path: "imputed.data.txt"
    type: "data"
    description: "Data with imputed values"
    format: "tsv"

execution:
  argsMapping:
    input_file: "--file_path"
    columns:
      flag: "--columns_name"
      transform: "comma-join"
    method: "--imputer_type"
    k: "--n_neighbors"
    strategy: "--simple_strategy"
    fillValue: "--fill_value"
    iterations: "--max_iter"

  outputDir: "--output_folder"

  requirements:
    python: ">=3.11"
    packages:
      - "numpy>=1.24.0"
      - "pandas>=2.0.0"
      - "scikit-learn>=1.3.0"

example:
  enabled: true
  values:
    input_file: "diann/imputed.data.txt"
    columns_source: "diann/imputed.data.txt"
    columns:
      - 'C:\Raja\DIA-NN searches\June 2022\LT-CBQCA-Test_DIA\RN-DS_220106_BCA_LT-IP_01.raw'
      - 'C:\Raja\DIA-NN searches\June 2022\LT-CBQCA-Test_DIA\RN-DS_220106_BCA_LT-IP_02.raw'
      - 'C:\Raja\DIA-NN searches\June 2022\LT-CBQCA-Test_DIA\RN-DS_220106_BCA_LT-IP_03.raw'
      - 'C:\Raja\DIA-NN searches\June 2022\LT-CBQCA-Test_DIA\RN-DS_220106_BCA_LT-MockIP_01.raw'
      - 'C:\Raja\DIA-NN searches\June 2022\LT-CBQCA-Test_DIA\RN-DS_220106_BCA_LT-MockIP_02.raw'
      - 'C:\Raja\DIA-NN searches\June 2022\LT-CBQCA-Test_DIA\RN-DS_220106_BCA_LT-MockIP_03.raw'
    method: "knn"
    k: 5
